<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Sign In</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <main>
        <div class="return">
            <a href="index.html">
                <button>
                    <img src="img/arrow_back.png" alt="arrow_back">
                </button>
            </a>
        </div>
        <div class="sign-in-form">
            <h2 class="text-color-blue text-align-center">Sign In</h2>
            <label class="text-color-blue">Email
               <br><input type="email" id="email" name="email" placeholder="email@test.com">
            </label>
            <label class="text-color-blue">Password
                <br><input type="password" id="password" name="password" placeholder="********">
            </label>
            <div class="helper-links vertical-align-center">
                <label>
                    <input type="checkbox" id="remember-me" name="remember-me">
                    Remember me
                </label>
                <a href="#" class="text-color-blue">
                    Forgot password?
                </a>
            </div>
            <button id="sign-in-button">Sign In</button>
            <script type="module">
                import {login} from "./script/auth.js"

                async function getCredentials() {
                    const email = document.getElementById("email").value;
                    const password = document.getElementById("password").value;
                    const response = await login(email, password);
                    if (!response.ok)
                    {
                        const old_error = document.getElementById("error");
                        console.log(old_error);
                        if (old_error)
                            old_error.remove();
                        const error = document.createElement("p");
                        error.innerHTML = (response.status == 400) ? "Invalid data" : "Wrong email or password";
                        error.id = "error";
                        const password_block = document.getElementById("password").parentElement;
                        password_block.after(error);
                    }
                    else
                    {
                        window.location.href = "index.html";
                    }
                }

                document.getElementById("sign-in-button").addEventListener("click", () => getCredentials());
            </script>
            <div class="bottom-links">
                <p>Don't have an account? <a href="sign-up.html" class="text-color-blue">Sign Up</a></p>
            </div>
        </div>
    </main>
</html>